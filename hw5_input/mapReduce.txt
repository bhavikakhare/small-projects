mapreduc simplifi data process larg cluster jeffrei dean sanjai ghemawat abstract apreduc program model implement process gener larg dataset amen broad varieti real world task user comput term map reduc function underli runtim system automat parallel comput larg scale cluster machin handl machin failur schedul inter machin commun make effici network disk programm find system easi ten thousand distinct mapreduc program implem intern googl past year averag hundr thousand mapreduc job execut googl cluster dai process total twenti petabyt data dai introduct prior develop mapreduc author googl implem hundr special purpos comput process larg amount raw data crawl docum web request log comput kind deriv data invert indic represent graph structur web docum summari number page crawl host set frequent queri dai comput conceptu straightforward input data larg comput distribut hundr thousand machin order finish reason amount time issu parallel comput distribut data handl failur conspir obscur origin simpl comput larg amount complex code deal issu reaction complex design abstract express simpl comput perform hide messi detail parallel fault toler data distribut load balanc librari abstract inspir map reduc primit present lisp function languag realiz comput involv appli map oper logic record input order comput set intermedi kei pair appli reduc oper valu share kei order combin deriv data appropri function model user map reduc oper parallel larg comput easili reexecut primari mechan fault toler biographi jeff dean jeff googl googl fellow work larg varieti larg scale distribut system googl mountain view ca facil sanjai ghemawat sanjai googl googl fellow work distribut comput infrastructur compani product base googl mountain view ca facil major contribut work simpl power interfac enabl automat parallel distribut larg scale comput combin implement interfac achiev high perform larg cluster commod pc program model parallel comput multipl core machin section describ basic program model exampl section describ implement mapreduc interfac tailor cluster base comput environ section describ refin program model found section perform measur implement varieti task section explor mapreduc googl includ experi basi rewrit product index system section discuss relat futur work program model comput take set input kei pair produc set output kei pair user mapreduc librari express comput function map reduc map written user take input pair produc set intermedi kei pair mapreduc librari group intermedi valu intermedi kei pass reduc function reduc function written user accept intermedi kei set valu kei merg valu form possibl smaller set valu typic output produc reduc invoc intermedi valu suppli user reduc function iter handl list valu larg fit memori problem count number occurr word larg collect docum user write code similar pseudocod commun acm januari vol map string kei string kei docum docum content word emitintermedi reduc string kei iter valu kei word valu list count int result valu result parseint emit asstr result map function emit word count occurr simpl reduc function sum count emit word addition user write code fill mapreduc specif object name input output file option tune paramet user invok mapreduc function pass specif object user code link mapreduc librari implem origin mapreduc paper full program text ten thousand distinct program implem mapreduc googl includ algorithm larg scale graph process text process data mine machin learn statist machin translat area discuss specif applic mapreduc found type previou pseudocod written term string input output conceptu map reduc function suppli user type map reduc list list list input kei valu drawn domain output kei valu intermedi kei valu domain output kei valu implement implement mapreduc interfac choic depend environ implement suitabl small share memori machin larg numa multiprocessor larger collect network machin origin articl open sourc implement mapreduc develop applic mapreduc varieti problem domain studi section describ implement mapreduc target comput environ wide googl larg cluster commod pc connect switch gigabit ethernet environ machin typic dual processor processor run linux gb memori machin individu machin typic gigabit network bandwidth bisect bandwidth machin con januari vol commun acm sider gigabit comput cluster thousand machin machin failur common storag provid inexpens id disk attach directli individu machin gf distribut file system develop hous manag data store disk file system replic provid avail reliabl top unreli hardwar user submit job schedul system job consist set task map schedul set machin cluster execut overview map invoc distribut multipl machin automat partition input data set split input split process parallel machin reduc invoc distribut partition intermedi kei space piec partition function hash kei mod number partition partition function user figur show flow mapreduc oper implement user program call mapreduc function sequenc action occur number label figur correspond number list mapreduc librari user program split input file piec typic mb piec control user option paramet start copi program cluster machin copi program master special rest worker assign work master map task reduc task assign master pick idl worker assign map task reduc task worker assign map task read content input split pars kei pair input data pass pair user defin map function intermedi kei pair produc map function buffer memori period buffer pair written local disk partition region partition function locat buffer pair local disk pass back master respons forward locat reduc worker reduc worker notifi master locat remot procedur call read buffer data local disk map worker reduc worker read intermedi data partition sort intermedi kei occurr kei group sort need typic kei map reduc task amount intermedi data larg fit memori extern sort reduc worker iter sort intermedi data uniqu intermedi kei encount pass kei set intermedi valu user reduc function output reduc function append final output file reduc partition mapreduc simplifi data process larg cluster user program fork fork fork master assign map assign reduc worker split split split read local write te emo rread worker write output file worker split split worker output file reduc phase output file worker input file map phasr intermedi file local disk fig execut overview map task reduc task complet master wake user program point mapreduc call user program return back user code success completion output mapreduc execut output file reduc task file name user typic user combin output file file pass file input mapreduc call distribut applic deal input partition multipl file master data structur master data structur map task reduc task store state idl progress complet ident worker machin nonidl task master conduit locat intermedi file region propag map task reduc task complet map task master store locat size intermedi file region produc map task updat locat size inform receiv map task complet inform push increment worker progress reduc task fault toler mapreduc librari design process larg amount data hundr thousand machin librari toler machin failur gracefulli handl worker failur master ping worker period respons receiv worker amount time master mark worker fail map task complet worker reset back initi idl state elig schedul worker similarli map task reduc task progress fail worker reset idl elig reschedul complet map task reexecut failur output store local disk fail machin inaccess complet reduc task reexecut output store global file system map task execut worker execut worker fail worker execut reduc task notifi reexecut reduc task read data worker read data worker mapreduc resili larg scale worker failur mapreduc oper network mainten run cluster caus group machin time unreach minut mapreduc master simpli reexecut work unreach worker machin continu make forward progress eventu complet mapreduc oper semant presenc failur user suppli map reduc oper determinist function input valu distribut implement produc output produc nonfault sequenti execut entir program commun acm januari vol reli atom commit map reduc task output achiev properti progress task write output privat temporari file reduc task produc file map task produc file reduc task map task complet worker send messag master includ name temporari file messag master receiv completion messag complet map task ignor messag record name file master data structur reduc task complet reduc worker atom renam temporari output file final output file reduc task execut multipl machin multipl renam call execut final output file reli atom renam oper provid underli file system guarante final file system state data produc execut reduc task vast major map reduc oper determinist fact semant equival sequenti execut case make easi programm reason program behavior map reduc oper nondeterminist provid weaker reason semant presenc nondeterminist oper output reduc task equival output produc sequenti execut nondeterminist program output reduc task correspond output produc sequenti execut nondeterminist program map task reduc task r ri execut commit execut weaker semant aris read output produc execut read output produc execut local network bandwidth scarc resourc comput environ conserv network bandwidth take advantag fact input data manag gf store local disk machin make cluster gf divid file mb block store copi block typic copi machin mapreduc master take locat inform input file account attempt schedul map task machin replica input data fail attempt schedul map task replica task input data worker machin network switch machin data run larg mapreduc oper signific fraction worker cluster input data read local consum network bandwidth task granular subdivid map phase piec reduc phase piec previous ideal larger number worker machin worker perform task improv dynam load balanc spe recoveri worker fail map task complet spread worker machin practic bound larg implement master make schedul decision state memori constant factor memori usag small piec state consist approxim byte data map task reduc task pair januari vol commun acm constrain user output reduc task end separ output file practic tend choos individu task roughli mb mb input data local optim previous effect make small multipl number worker machin expect perform mapreduc comput worker machin backup task common lengthen total time mapreduc oper straggler machin take unusu long time complet map reduc task comput straggler aris host reason machin bad disk experi frequent correct error slow read perform mb mb cluster schedul system schedul task machin caus execut mapreduc code slowli due competit cpu memori local disk network bandwidth recent problem experienc bug machin initi code caus processor cach disabl comput affect machin slow factor hundr gener mechan allevi problem straggler mapreduc oper close completion master schedul backup execut remain progress task task mark complet primari backup execut complet tune mechan typic increas comput resourc oper percent found significantli reduc time complet larg mapreduc oper sort program section take longer complet backup task mechan disabl refin basic function provid simpli write map reduc function suffici found extens includ user partition function determin map intermedi kei valu reduc shard order guarante implement guarante reduc partition intermedi kei pair process increas kei order user combin function partial combin gener intermedi valu kei map task reduc amount intermedi data transfer network custom input output type read input format produc output format mode execut singl machin simplifi debug small scale test origin articl detail discuss of item mapreduc simplifi data process larg cluster perform section measur perform mapreduc comput run larg cluster machin comput search approxim terabyt data pattern comput sort approxim terabyt data program repres larg subset real program written user mapreduc class program shuffl data represent anoth class extract small amount interest data larg dataset cluster configur sort program consist line user code final sort output written set replic gf file terabyt written output program input data split mb piec partition sort output file partition function initi byte kei segreg piec partition function benchmark built knowledg distribut kei gener sort program add prepass mapreduc oper collect sampl kei distribut sampl kei comput splitpoint final sort pass program execut cluster consist approxim machin machin ghz intel xeon processor hyper thread enabl gb memori gb id disk gigabit ethernet link machin arrang level tree shape switch network approxim gbp aggreg bandwidth root machin host facil roundtrip time pair machin millisecond gb memori approxim gb reserv task run cluster program execut weekend afternoon cpu disk network idl grep grep program scan byte record search rare charact pattern pattern occur record input split approxim mb piec entir output file fig data transfer rate time mr grep figur show progress comput time axi show rate input data scan rate gradual pick machin assign mapreduc comput peak gb worker assign map task finish rate start drop hit second comput entir comput take approxim second start finish includ minut startup overhead overhead due propag program worker machin delai interact gf open set input file inform need local optim sort sort program sort byte record approxim terabyt data program model terasort benchmark fig data transfer rate time mr sort figur show progress normal execut sort program top left graph show rate input read rate peak gb di fairli quickli map task finish second elaps note input rate commun acm januari vol grep sort map task spend half time bandwidth write intermedi output local disk intermedi output grep neglig size thing note input rate higher shuffl rate output rate local optim data read local disk bypass bandwidth constrain network shuffl rate higher output rate output phase write copi sort data make replica output reliabl avail reason write replica mechan reliabl avail provid underli file system network bandwidth requir write data reduc underli file system erasur code replic origin articl experi examin effect backup task machin failur experi wrote version mapreduc librari februari made signific enhanc august includ local optim dynam load balanc task execut worker machin time pleasantli surpris broadli applic mapreduc librari kind problem work wide rang domain googl includ larg scale machin learn problem cluster problem googl new froogl product extract data produc report popular queri googl zeitgeist googl trend extract properti web page experi product extract geograph locat larg corpu web page local search process satellit imageri data languag model process statist machin translat larg scale graph comput figur show signific growth number separ mapreduc program check primari sourc code manag system time earli septemb march mapreduc success make write simpl program run effici thousand machin half hour greatli speed develop prototyp cycl programm experi distribut parallel system exploit larg amount resourc easili tabl mapreduc statist month number job avg completion time sec machin year map input data tb map output data tb reduc output data tb avg machin job uniqu implement map reduc aug mar sep end job mapreduc librari log statist comput resourc job tabl show statist subset mapreduc job run googl month highlight extent mapreduc grown de facto choic data process googl larg scale index signific mapreduc date complet rewrit product index system produc data structur googl web search servic index system take input larg set docum retriev crawl system store set gf file raw content docum terabyt data time convert index system mapreduc ran sequenc mapreduc oper time eas phase ad phase ad index system mapreduc ad hoc distribut pass prior version index system provid benefit index code simpler smaller easier understand code deal fault toler distribut parallel hidden mapreduc librari size phase comput drop approxim line code approxim line express mapreduc fig mapreduc instanc time januari vol commun acm perform mapreduc librari good conceptu unrel comput separ mix avoid extra pass data make easi chang index process chang month make index system dai implem system mapreduc simplifi data process larg cluster index process easier oper problem caus machin failur slow machin network hiccup dealt automat mapreduc librari oper intervent easi improv perform index process ad machin index cluster acknowledg josh levenberg instrument revis extend userlevel mapreduc api number featur work system user mapreduc googl engin organ provid help feedback suggest bug report refer relat work system provid restrict program model restrict parallel comput automat associ function comput prefix elem arrai log time processor parallel prefix comput mapreduc consid simplif distil model base experi larg real world comput significantli provid fault toler implement scale thousand processor contrast parallel process system implem smaller scale leav detail handl machin failur programm local optim draw inspir techniqu activ disk comput push process elem close local disk reduc amount data subsystem network sort facil part mapreduc librari similar oper sort sourc machin map worker partition data sort send reduc worker reduc worker sort data local memori sort user defin map reduc function make librari wide applic bad f tacc system reli reexecut mechan implem fault toler origin articl complet treatment relat work conclusion mapreduc program model successfulli googl purpos attribut success reason model easi programm experi parallel distribut system hide detail parallel fault toler local optim load balanc larg varieti problem easili express mapreduc comput mapreduc gener data googl product web search servic sort data mine machin learn system develop implement mapreduc scale larg cluster machin compris thousand machin implement make effici machin resourc suitabl larg comput problem encount googl restrict program model made easi parallel distribut comput make comput fault toler network bandwidth scarc resourc number optim system target reduc amount data network local optim read data local disk write singl copi intermedi data local disk save network bandwidth redund execut reduc impact slow machin handl machin failur data loss hadoop open sourc implement mapreduc lucen apach org hadoop phoenix system mapreduc program stanford christo sw phoenix arpaci dusseau arpaci dusseau culler hellerstein patterson high perform sort network workstat proceed acm sigmod intern confer manag data tucson az barroso dean ur lzle web search planet googl cluster architectur ieee micro bent thain arpaci dusseau arpaci dusseau livni explicit control batch awar distribut file system proceed st usenix symposium network system design implement nsdi blelloch scan primit parallel oper ieee tran comput chu kim lin yu bradski ng olukotun map reduc machin learn multicor proceed neural inform process system confer nip vancouv canada dean ghemawat mapreduc simplifi data process larg cluster proceed oper system design implement osdi san francisco ca fox gribbl chawath brewer gauthier cluster base scalabl network servic proceed acm symposium oper system principl saint malo franc ghemawat gobioff leung googl file system symposium oper system principl lake georg ny gorlatch systemat effici parallel scan list homomorph boug fraigniaud mignott robert ed euro par parallel process lectur note comput scienc vol springer verlag grai sort benchmark home page barc sortbenchmark huston sukthankar wickremesingh satyanarayanan ganger riedel ailamaki diamond storag architectur earli discard interact search proceed usenix file storag technologi fast confer ladner fischer parallel prefix comput jacm rabin effici dispers inform secur load balanc fault toler jacm ranger raghuraman penmetsa bradski kozyraki evalu mapreduc multi core multiprocessor system proceed intern symposium high perform comput architectur hpca phoenix az riedel faloutso gibson nagl activ disk larg scale data process ieee comput commun acm januari vol